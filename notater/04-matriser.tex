\input{kapittel}

\kapittel{4}{Matriser}
\label{ch:matriser}



\section*{Definisjoner og notasjon}

%% TODO: definer kolonnevektor (søylevektor) og radvektor

%% TODO: notasjon (v_1, ..., v_n) for kolonnevektor

En \defterm{$m \times n$-matrise} er en rektangulær tabell med tall
som har $m$~tall i høyden og $n$~tall i bredden:
\[
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
\]
\defterm{Kolonnene} i matrisen er følgende kolonnevektorer:
\[
\vvvv{a_{11}}{a_{21}}{\vdots}{a_{m1}}\qquad
\vvvv{a_{12}}{a_{22}}{\vdots}{a_{m2}}\qquad
\cdots\qquad
\vvvv{a_{1n}}{a_{2n}}{\vdots}{a_{mn}}\qquad
\]
\defterm{Radene} i matrisen er følgende radvektorer:
\begin{gather*}
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n}
\end{bmatrix}
\\
\begin{bmatrix}
a_{21} & a_{22} & \cdots & a_{2n}
\end{bmatrix}
\\
\vdots
\\
\begin{bmatrix}
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
\end{gather*}

\begin{ex}
Her er et eksempel på en $2 \times 3$-matrise:
\[
\begin{bmatrix}
5 & 0 & -2 \\
3 & 1 &  4
\end{bmatrix}
\]
Kolonnene i denne matrisen er:
\[
\vv{5}{3},\quad
\vv{0}{1}\quad\text{og}\quad
\vv{-2}{4}
\]
Radene er:
\[
\begin{bmatrix}
5 & 0 & -2
\end{bmatrix}
\quad\text{og}\quad
\begin{bmatrix}
3 & 1 &  4
\end{bmatrix}
\qedhere
\]
\end{ex}

Noen ganger har vi en liste med kolonnevektorer, si
\[
\V{v}_1,\ \V{v}_2,\ \ldots,\ \V{v}_n,
\]
og vil lage en matrise som har disse vektorene som kolonner.
Den matrisen kan vi skrive slik:
\[
\begin{bmatrix}
\V{v}_1 & \V{v}_2 & \cdots & \V{v}_n
\end{bmatrix}
\]
Hvis vektorene ligger i~$\R^m$, blir dette en $m \times n$-matrise.

\begin{ex}
La
\[
\V{v}_1 = \vvv{2}{0}{4}
\qquad\text{og}\qquad
\V{v}_2 = \vvv{1}{1}{2}
\]
være to vektorer i~$\R^3$.  Matrisen
$\begin{bmatrix} \V{v}_1 & \V{v}_2 \end{bmatrix}$ med disse vektorene
som kolonner blir da følgende $3 \times 2$-matrise:
\[
\begin{bmatrix} \V{v}_1 & \V{v}_2 \end{bmatrix}
=
\begin{bmatrix}
2 & 1 \\
1 & 0 \\
2 & 4
\end{bmatrix}
\qedhere
\]
\end{ex}

På samme måte kan vi, hvis vi har en liste med radvektorer
\[
\V{r}_1,\ \V{r}_2,\ \ldots,\ \V{r}_m,
\]
lage en matrise
\[
\begin{bmatrix}
\V{r}_1 \\
\V{r}_2 \\
\vdots \\
\V{r}_m
\end{bmatrix}
\]
med disse vektorene som rader.

\begin{ex}
La
\[
\V{r}_1 = \begin{bmatrix} 2 & 1 \end{bmatrix},\quad
\V{r}_2 = \begin{bmatrix} 1 & 0 \end{bmatrix}
\quad\text{og}\quad
\V{r}_3 = \begin{bmatrix} 2 & 4 \end{bmatrix}
\]
være tre radvektorer.  Da har vi:
\[
\begin{bmatrix}
\V{r}_1 \\
\V{r}_2 \\
\V{r}_3
\end{bmatrix}
=
\begin{bmatrix}
2 & 1 \\
1 & 0 \\
2 & 4
\end{bmatrix}
\qedhere
\]
\end{ex}


\section*{Produkt av matrise og vektor}

La
\[
A =
\begin{bmatrix}
\V{a}_1 & \V{a}_2 & \cdots & \V{a}_n
\end{bmatrix}
\]
være en $m \times n$-matrise med vektorene $\V{a}_1$, $\V{a}_2$,
\ldots, $\V{a}_n$ som kolonner, og la
\[
\V{v} = \vn{v}{n}
\]
være en vektor i~$\R^n$.  Vi definerer produktet $A\V{v}$ av $A$
og~$\V{v}$ som lineærkombinasjonen av kolonnene i~$A$ med tallene
i~$\V{v}$ som vekter:
\[
A \V{v} = \V{a}_1 v_1 + \V{a}_2 v_2 + \cdots + \V{a}_n v_n
\]
Merk at produktet~$A \V{v}$ bare er definert når bredden av matrisen
$A$ er lik høyden av vektoren~$\V{v}$.

\begin{ex}
\label{ex:Av}
Vi regner ut produktet av en $2 \times 3$-matrise og en vektor
i~$\R^3$:
\begin{align*}
\begin{bmatrix}
5 & 0 & -2 \\
3 & 1 &  4
\end{bmatrix}
\vvv{2}{-1}{3}
&=
\vv{5}{3} \cdot 2 +
\vv{0}{1} \cdot (-1) +
\vv{-2}{4} \cdot 3
\\
&= \vv{5 \cdot 2 + 0 \cdot (-1) + (-2) \cdot 3}
      {3 \cdot 2 + 1 \cdot (-1) +   4  \cdot 3}
\\
&= \vv{4}{17}
\end{align*}
Merk at resultatet blir en vektor i~$\R^2$.
\end{ex}

Når vi skal regne ut et produkt $A \V{v}$ av en matrise og en vektor,
trenger vi ikke egentlig å skrive opp lineærkombinasjonen av kolonnene
i $A$ med vekter fra $\V{v}$ slik som vi gjorde i eksempelet over.
Den andre linjen av utregningen i eksempelet viser en mer direkte måte
å komme frem på: Tallet som skal være på første posisjon i
resultatvektoren får vi ved å gange tallene fra første rad i~$A$ med
tallene i~$\V{v}$, og legge sammen resultatene.  Tallet på andre
posisjon i resultatvektoren får vi på samme måte fra andre rad i~$A$.

Generelt har vi at dersom
\[
A =
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
\quad\text{og}\quad
\V{v} = \vn{v}{n},
\]
så kan vi regne ut produktet $A \V{v}$ på følgende måte:
\[
A \V{v} =
\vvvv{a_{11} v_1 + a_{12} v_2 + \cdots + a_{1n} v_n}
     {a_{21} v_1 + a_{22} v_2 + \cdots + a_{2n} v_n}
     {\vdots}
     {a_{m1} v_1 + a_{m2} v_2 + \cdots + a_{mn} v_n}
\]
(Det er ikke vanskelig å se at dette følger fra definisjonen
av~$A \V{v}$.)



\begin{thm}
\label{thm:Av-lin-komb}
Hvis $A$ er en $m \times n$-matrise, $\V{v}$ og~$\V{w}$ er vektorer
i~$\R^n$ og $c$ er et tall, så har vi følgende likheter:
\[
A (\V{v} + \V{w}) = A \V{v} + A \V{w}
\qquad\text{og}\qquad
A (c \V{v}) = c (A \V{v})
\]
\end{thm}

\begin{ex}
La $A$ og~$\V{v}$ være følgende matrise og vektor:
\[
A =
\begin{bmatrix}
5 & 0 & -2 \\
3 & 1 &  4
\end{bmatrix}
\quad\text{og}\quad
\V{v} = \vvv{2}{-1}{3}
\]
I eksempel~\ref{ex:Av} regnet vi ut produktet $A \V{v}$.
Men hva om vi har lyst til å gange $A$ med vektoren $(8, -4, 12)$?
Siden denne vektoren er lik $4 \cdot \V{v}$ kan vi bruke
teorem~\ref{thm:Av-lin-komb} og få:
\[
A \vvv{8}{-4}{12}
= A \cdot (4 \cdot \V{v})
= 4 \cdot (A \cdot \V{v})
= 4 \cdot \vv{4}{17}
= \vv{16}{68}
\]
Altså: $A$ ganget med vektoren $4 \V{v}$ er det samme som $4$ ganger
vektoren $A \V{v}$.
% \[
% \begin{bmatrix}
% 5 & 0 & -2 \\
% 3 & 1 &  4
% \end{bmatrix}
% \vvv{2}{-1}{3}
% = \vv{4}{17}
% \]
% Hva om vi vil gange den samme matrisen med vektoren $(8, -4, 12)$?
% Siden denne vektoren er lik $4 \cdot (2,-1,3)$, kan vi bruke
% teorem~\ref{thm:Av-lin-komb} og få:
% \begin{align*}
% \begin{bmatrix}
% 5 & 0 & -2 \\
% 3 & 1 &  4
% \end{bmatrix}
% \vvv{8}{-4}{12}
% &= 
% \begin{bmatrix}
% 5 & 0 & -2 \\
% 3 & 1 &  4
% \end{bmatrix}
% \left( 4 \cdot \vvv{2}{-1}{3} \right)
% \\
% &=
% 4 \cdot \left(
% \begin{bmatrix}
% 5 & 0 & -2 \\
% 3 & 1 &  4
% \end{bmatrix}
% \vvv{2}{-1}{3} \right)
% \\
% &=
% 4 \cdot \vv{4}{17}
% = \vv{16}{68}
% \end{align*}
\end{ex}

Det er verdt å merke seg hva som skjer hvis vi ganger en matrise med
en vektor der nøyaktig ett av tallene er~$1$, og resten er~$0$.  La
oss teste dette med en eksempelmatrise:

\begin{ex}
Vi ganger $2 \times 3$-matrisen
\[
A =
\begin{bmatrix}
5 & 0 & -2 \\
3 & 1 &  4
\end{bmatrix}
\]
med de tre vektorene
\[
\V{e}_1 = \vvv{1}{0}{0},\quad
\V{e}_2 = \vvv{0}{1}{0}\quad\text{og}\quad
\V{e}_3 = \vvv{0}{0}{1}
\]
og får følgende:
\begin{align*}
A \V{e}_1 &= \vv{5}{3} \\
A \V{e}_2 &= \vv{0}{1} \\
A \V{e}_3 &= \vv{-2}{4}
\end{align*}
Resultatene ble altså de tre kolonnene i~$A$.
\end{ex}

Generelt har vi at hvis $A$ er en $m \times n$-matrise, og $\V{e}_1$,
$\V{e}_2$, \ldots, $\V{e}_n$ er vektorene i~$\R^n$ som er slik at
$\V{e}_i$ har et $1$-tall i sin $i$-te koordinat og bare $0$-er
ellers, så er
\[
A \V{e}_1,\quad
A \V{e}_2,\quad
\ldots,\quad
A \V{e}_n
\]
nøyaktig samme vektorer som kolonnene i~$A$.


\section*{Sum og skalering av matriser}

La $A$ og~$B$ være to $m \times n$-matriser:
\[
A =
\begin{bmatrix}
a_{11} & \cdots & a_{1n} \\
a_{21} & \cdots & a_{2n} \\
\vdots & \ddots & \vdots \\
a_{m1} & \cdots & a_{mn}
\end{bmatrix}
\qquad
B =
\begin{bmatrix}
b_{11} & \cdots & b_{1n} \\
b_{21} & \cdots & b_{2n} \\
\vdots & \ddots & \vdots \\
b_{m1} & \cdots & b_{mn}
\end{bmatrix}
\]
% \[
% A =
% \begin{bmatrix}
% a_{11} & a_{12} & \cdots & a_{1n} \\
% a_{21} & a_{22} & \cdots & a_{2n} \\
% \vdots & \vdots & \ddots & \vdots \\
% a_{m1} & a_{m2} & \cdots & a_{mn}
% \end{bmatrix}
% \qquad
% B =
% \begin{bmatrix}
% b_{11} & b_{12} & \cdots & b_{1n} \\
% b_{21} & b_{22} & \cdots & b_{2n} \\
% \vdots & \vdots & \ddots & \vdots \\
% b_{m1} & b_{m2} & \cdots & b_{mn}
% \end{bmatrix}
% \]
Vi definerer summen $A+B$ på den mest åpenbare måten -- vi legger
sammen tallene fra de to matrisene i hver posisjon, og får en ny
$m \times n$-matrise:
\[
A + B =
\begin{bmatrix}
a_{11} + b_{11} & a_{12} + b_{12} & \cdots & a_{1n} + b_{1n} \\
a_{21} + b_{21} & a_{22} + b_{22} & \cdots & a_{2n} + b_{2n} \\
\vdots          & \vdots          & \ddots & \vdots          \\
a_{m1} + b_{m1} & a_{m2} + b_{m2} & \cdots & a_{mn} + b_{mn} \\
\end{bmatrix}
\]

Produktet av et tall og en matrise defineres også på den åpenbare
måten -- vi ganger med tallet på hver plass i matrisen:
\[
c A =
\begin{bmatrix}
c \cdot a_{11} & c \cdot a_{12} & \cdots & c \cdot a_{1n} \\
c \cdot a_{21} & c \cdot a_{22} & \cdots & c \cdot a_{2n} \\
\vdots         & \vdots         & \ddots & \vdots         \\
c \cdot a_{m1} & c \cdot a_{m2} & \cdots & c \cdot a_{mn}
\end{bmatrix}
\]

% \begin{ex}
% TODO: nødvendig med eksempel?
% \end{ex}

\begin{thm}
Hvis $A$ og~$B$ er $m \times n$-matriser, $\V{v}$ er en vektor
i~$\R^n$ og $c$ er et tall, så har vi følgende likheter:
\[
(A + B) \V{v} = A \V{v} + B \V{v}
\qquad\text{og}\qquad
(c A) \V{v} = c (A \V{v})
\]
\end{thm}


\section*{Vektorer som matriser}

%TODO


\section*{Matrisemultiplikasjon}

Nå kommer vi til den mest spennende av de aritmetiske operasjonene vi
kan gjøre med matriser, nemlig \emph{matrisemultiplikasjon}.

Det er litt mer komplisert å beskrive hvordan vi multipliserer
matriser enn hvordan vi summerer dem.  Det er imidlertid en god grunn
til at det er slik.  Vi kunne valgt å definere multiplikasjon av
matriser på tilsvarende måte som sum, men det ville ikke blitt
spesielt nyttig.  Vi vil nemlig at matrisemultiplikasjon skal oppføre
seg pent sammen med multiplikasjon av matriser med vektorer.  Spesielt
vil vi at følgende likhet skal holde:
\[
(AB) \V{v} = A (B \V{v})
\]
Vi vil altså at vi fritt skal kunne flytte parentesene, akkurat slik
vi kan gjøre med et produkt av tre tall.

Hvordan kan vi definere produkt av matriser slik at dette fungerer?
La oss først se på et eksempel.

\begin{ex}
% TODO eksempel med 3x3 e.l.?
5 0 -2
3 1 4

2 1
1 0
2 4


2
1
2

1
0
4





6  -3
15 19




\end{ex}

\begin{ex}
\[
A =
\begin{bmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{bmatrix}
\qquad
B =
\begin{bmatrix}
b_{11} & b_{12} \\
b_{21} & b_{22}
\end{bmatrix}
\]
\[
B \vv{1}{0} = \vv{b_{11}}{b_{21}}
\]


\[
\begin{bmatrix}
a_{11} b_{11} + a_{12} b_{21} & a_{11} b_{12} + a_{12} b_{22} \\
a_{21} b_{11} + a_{22} b_{21} & a_{21} b_{12} + a_{21} b_{22}
\end{bmatrix}
\]
\end{ex}


\[
AB =
\begin{bmatrix}
A \V{b}_1 & A \V{b}_2 & \cdots & A \V{b}_p
\end{bmatrix}
\]

% \[
% AB =
% \begin{bmatrix}
% a_{11} b_{11} + a_{12} b_{21} + \cdots + a_{1n} b_{n1}
% \end{bmatrix}
% \]


\begin{thm}
\begin{align*}
(AB) \V{v} &= A (B \V{v}) \\
(c A) B &= c (AB) = A (cB) \\
A(BC) &= (AB)C
\end{align*}
\end{thm}


\section*{Identitetsmatriser}


\section*{Inverser}


\kapittelslutt
