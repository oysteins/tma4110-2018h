\input{kapittel}

\kapittel{12}{Projeksjon}
\label{ch:projeksjon}

\section*{Adjungering}

Vi skal begynne med å utvide transponeringsoperasjonen litt. 

\begin{defn}
La
\[
A =
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
\]
være en kompleks $m \times n$-matrise.  Den \defterm{adjungerte} av~$A$ er
$n \times m$-matrisen
\[
A^* =
\begin{bmatrix}
\overline a_{11} & \overline a_{21} & \cdots & \overline a_{m1} \\
\overline a_{12} & \overline a_{22} & \cdots & \overline a_{m2} \\
\vdots & \vdots & \ddots & \vdots \\
\overline a_{1n} & \overline a_{2n} & \cdots & \overline a_{mn}
\end{bmatrix}
\]
der radene og kolonnene i~$A$ er byttet om, og alt er komplekskonjugert.
\end{defn}

\begin{merkx}
Å adjungere en reell matrise er det samme som å transponere den.
\end{merkx}

\begin{ex}
Hvis vi lar $A$ være matrisen
\[
A =
\begin{bmatrix}
5i & 0 & -2i \\
3 & i &  4
\end{bmatrix},
\]
så er den adjungerte av~$A^*$ gitt ved:
\[
A^* =
\begin{bmatrix}
 -5i & 3 \\
 0 & -i \\
2i & 4
\end{bmatrix}
\]
Hvis vi adjungerer denne matrisen igjen, så kommer vi tilbake til
utgangspunktet:
\[
(A^*)^* = A\qedhere
\]
\end{ex}

Vi tar med noen regneregler for adjungering.

\begin{thm}
For enhver matrise~$A$ har vi at å adjungere to ganger gir den
opprinnelige matrisen:
\[
(A^*)^* = A
\]
Hvis $A$ og~$B$ er matriser sik at produktet~$AB$ er definert, så er
den adjungerte av produktet lik produktet av de adjungerte, i
motsatt rekkefølge:
\[
(AB)^* = B^* A^*
\]
\end{thm}


\section*{Skalarproduktet}
La $\V{v}$ og $\V{w}$ være kolonnevektorer i $\C^n$. 
\defterm{Indreproduktet} mellom dem er definert som:
\[
\V{v}^* \V{w}= \overline v_1 w_1 + \overline v_2 w_2 + \cdots +\overline v_n w_n
 \] 
 \defterm{Ytreproduktet} er:
\begin{align*}
 \V{w} \V{v}^*&=
\begin{bmatrix}
w_1 \overline v_1       & w_1 \overline v_2             & \cdots & w_1 \overline v_n \\
w_2 \overline v_1     & w_2 \overline v_2              & \cdots & w_2 \overline v_n   \\
\vdots & \vdots & \vdots  & \vdots \\
w_n \overline v_1     & w_n \overline v_2              & \cdots & w_n \overline v_n   \\
\end{bmatrix}
\\[3pt]&=
\begin{bmatrix}
\V w  \overline v_1 & \V w \overline v_2  & \hdots & \V w \overline v_n 
\end{bmatrix}
%+
%\overline v_2
%\begin{bmatrix}
%w_1  \\
%w_2  \\
%\vdots  \\
%w_n  \\
%\end{bmatrix}
%+...+
%\overline v_n
%\begin{bmatrix}
%w_1  \\
%w_2  \\
%\vdots  \\
%w_n  \\
%\end{bmatrix}
 \end{align*}  
 Vi har definert indre- og ytreprodukt for kolonnevektorer. 
 Det er ikke noe problem å sette opp tilsvarende definisjoner for rekkevektorer, 
 men det skal vi ikke plage dere med. 
 Vi definerer \defterm{lengden} til en vektor $\V v$ som 
 \[
 \|\V v\|=\sqrt{\V{v}^*\V{v}},
 \]
 og vi sier at $\V{v}$ og $\V{w}$ er \defterm{ortogonale} dersom 
\[
 \V{v}^*\V{w}=\V{w}^*\V{v} = 0.
 \] 
 

 
 \begin{merkx}
 Dersom $\V{v}$ og $\V{w}$ er reelle, blir indreproduktet 
\[
\V{v}^* \V{w}=\V{v}^T\V{w}= v_1w_1 + v_2w_2 + \cdots +v_nw_n=\V{v}\cdot  \V{w}
 \] 
 slik du er vant til fra gymnaset. Resultatet av dette produktet er en skalar, og derfor kaller man det gjerne skalarproduktet.  
 \end{merkx}
 
 \begin{merkx}
 Ytreproduktet $ \V{w} \V{v}^*$ er en ikke inverterbar matrise, siden alle kolonnene er parallelle.
 \end{merkx}
 
 

 \begin{ex}
I $\R^2$ er $\V{v}$ og $\V{w}$ ortogonale dersom vinkelen mellom dem er $\pi/2$.
\end{ex}


 \begin{ex}
 Vektorene 
 \[
 \begin{bmatrix}
 1 \\ 
 1 \\
 -1\\
 0
 \end{bmatrix}
 \quad
 \text{og}
 \quad
  \begin{bmatrix}
 0 \\ 
 1 \\
 1\\
 1
 \end{bmatrix}
\]
er ortogonale. 
 \end{ex}

 \begin{ex}
 Vektorene 
 \[
 \begin{bmatrix}
 1 \\ 
 i 
 \end{bmatrix}
 \quad
 \text{og}
 \quad
  \begin{bmatrix}
 i \\ 
1
 \end{bmatrix}
\]
er ortogonale. 
 \end{ex}


 \begin{ex}
 Vektoren $\V{v}=\frac{\V{w}}{\|\V{w}\|}$ har lengde 1 for alle $\V w \neq 0$.
 \end{ex}
 
 \section*{Projeksjon i $\R^2$}
Vi bruker skalarproduktet til å projisere vektorer på hverandre. Det sentrale spørsmålet er: hvor lange er de røde og blå lengdene i figuren under? 
 \begin{center}
\begin{tikzpicture}[scale=.42]
\draw[-latex,thick] (0,0) -- (7,1);
\draw[-latex,thick] (0,0) -- (3,6);
\draw[-, thick, red] (0,0) -- (27/50*7,27/50*1);
\draw[-,thick, blue] (27/50*7,27/50*1) -- (3,6);
\draw[-]  (27/50*7-1/7,27/50*1+1-1/77) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\draw[-]  (27/50*7+1,27/50*1+1/7) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\node[anchor=east] at (9,1.2) {\footnotesize $\V{v}$};
\node[anchor=south] at (3.5,7) {\footnotesize $\V{w}$};
\node[anchor=east,red] at (3,-.5) {\footnotesize $w_{\V{v}}$};
\node[anchor=east,blue] at (5.5,3) {\footnotesize $w_{\V{v}^{\perp}}$};
%\foreach \x in {-4,-3,-2,-1,1,2,3,4,5,6}
%\draw (\x,5pt) -- (\x,-5pt);
%\foreach \y in {-4,-3,-2,-1,1,2,3,4,5}
%\draw (5pt,\y) -- (-5pt,\y);
%\filldraw (2,3) circle [radius=3pt] node[anchor=west] {$z=2+3i$};
%\filldraw (2,-3) circle [radius=3pt] node[anchor=west] {$\overline z=2-3i$};
%\filldraw (4,5) circle [radius=3pt] node[anchor=west] {$w=4+5i$};
%\filldraw (0,1) circle [radius=3pt] node[anchor=east] {$\V{e}_2$};
%\filldraw (-1,-2) circle [radius=3pt] node[anchor=east] {$\V{u}$};
%\filldraw (3,2) circle [radius=3pt] node[anchor=east] {$\V{v}$};
%\filldraw (1,4) circle [radius=3pt] node[anchor=south] {$A \V{e}_1$};
%\filldraw (3,-3) circle [radius=3pt] node[anchor=north] {$A \V{e}_2$};
%\filldraw (-7,2) circle [radius=3pt] node[anchor=east] {$A \V{u}$};
%\filldraw (9,6) circle [radius=3pt] node[anchor=north] {$A \V{v}$};
%\draw[->,shorten <=4pt,shorten >=4pt] (1,0) to[bend right=20] (1,4);
%\draw[->,shorten <=4pt,shorten >=4pt] (0,1) to[bend right=30] (3,-3);
%\draw[->,shorten <=4pt,shorten >=4pt] (-1,-2) to[bend right=20] (-7,2);
%\draw[->,shorten <=4pt,shorten >=4pt] (3,2) to[bend left=20] (9,6);
\end{tikzpicture}
\\
{\small \textit{Hva er projeksjon?}}
\end{center}
I to dimensjoner er det lett å vise at skalarproduktet også kan beregnes som 
\[
 \V{v}\cdot  \V{w} = \|\V v\| \|\V w\| \cos \theta,
 \] 
der $\theta$ er vinkelen mellom $\V{v}$ og $\V{w}$. Vet man det, kan man beregne den røde lengden:
\[
w_{\V{v}}=\|\V w\| \cos \theta=\frac{\|\V v\|}{\|\V v\|} \|\V w\| \cos \theta =\frac{\V v \cdot \V w}{\|\V v\|}.
\]
Den blå lengden kan så beregnes med pytagoras:
\[
w_{\V{v}^{\perp}}=\sqrt{\|\V w\|^2-\left(\frac{\V v \cdot \V w}{\|\V v\|}\right)^2}.
\]
Denne lengden kalles $\V w$ sin skalarprojeksjon på normalen til $\V w$. Hvis vi tenker at de røde og blå lengdene er vektorer, kan de skrives
\[
\V w_{\V{v}}=w_{\V{v}}\frac{\V v}{\|\V v\|}=\frac{\V v \cdot \V w}{\|\V v\|^2}\V v=\frac{\V v \cdot \V w}{\V v \cdot \V v}\V v
\]
og
\[
\V w - \V w_{\V{v}}.
\]
 \begin{center}
\begin{tikzpicture}[scale=.42]
\draw[-latex,thick] (0,0) -- (7,1);
\draw[-latex,thick] (0,0) -- (3,6);
\draw[-latex, thick, red] (0,0) -- (27/50*7,27/50*1);
\draw[-latex,thick, blue] (27/50*7,27/50*1) -- (3,6);
\draw[-]  (27/50*7-1/7,27/50*1+1-1/77) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\draw[-]  (27/50*7+1,27/50*1+1/7) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\node[anchor=east] at (9,1.2) {\footnotesize $\V{v}$};
\node[anchor=south] at (3.5,7) {\footnotesize $\V{w}$};
\node[anchor=east,red] at (3,-.5) {\footnotesize $\V w_{\V{v}}$};
\node[anchor=east,blue] at (5.5,3) {\footnotesize $\V w_{\V{v}^{\perp}}$};
%\foreach \x in {-4,-3,-2,-1,1,2,3,4,5,6}
%\draw (\x,5pt) -- (\x,-5pt);
%\foreach \y in {-4,-3,-2,-1,1,2,3,4,5}
%\draw (5pt,\y) -- (-5pt,\y);
%\filldraw (2,3) circle [radius=3pt] node[anchor=west] {$z=2+3i$};
%\filldraw (2,-3) circle [radius=3pt] node[anchor=west] {$\overline z=2-3i$};
%\filldraw (4,5) circle [radius=3pt] node[anchor=west] {$w=4+5i$};
%\filldraw (0,1) circle [radius=3pt] node[anchor=east] {$\V{e}_2$};
%\filldraw (-1,-2) circle [radius=3pt] node[anchor=east] {$\V{u}$};
%\filldraw (3,2) circle [radius=3pt] node[anchor=east] {$\V{v}$};
%\filldraw (1,4) circle [radius=3pt] node[anchor=south] {$A \V{e}_1$};
%\filldraw (3,-3) circle [radius=3pt] node[anchor=north] {$A \V{e}_2$};
%\filldraw (-7,2) circle [radius=3pt] node[anchor=east] {$A \V{u}$};
%\filldraw (9,6) circle [radius=3pt] node[anchor=north] {$A \V{v}$};
%\draw[->,shorten <=4pt,shorten >=4pt] (1,0) to[bend right=20] (1,4);
%\draw[->,shorten <=4pt,shorten >=4pt] (0,1) to[bend right=30] (3,-3);
%\draw[->,shorten <=4pt,shorten >=4pt] (-1,-2) to[bend right=20] (-7,2);
%\draw[->,shorten <=4pt,shorten >=4pt] (3,2) to[bend left=20] (9,6);
\end{tikzpicture}
\\
{\small \textit{Hva er projeksjon II?}}
\end{center}
Tenker man på projeksjonene til $\V w$ på $\V v$ og $\V v^{\perp}$ som en lengder, kalles det skalarprojeksjon, og tenker man på det som vektorer, kalles det vektorprojeksjon. Det er egentlig ett fett hva man foretrekker.

%Vi skal ta dette for god fisk, og definere
%\[
% \theta = \cos^{-1} \frac{ \V{v}\cdot  \V{w}}{\|v\| \|w\|} 
% \] 
%som vinkelen mellom vektorer i $\R^n$.
 


% \section*{Projeksjon i $\R^3$}

 \section*{Projeksjon i $\C^n$}
En projeksjon er en lineærtransformasjon $P$ som tilfredsstiller
\[
 P\V x=P^2\V x.
 \]
 for alle $\V x$. 
 \begin{ex}
Både nullmatrisen og identitetsmatrisen er projeksjoner.
 \end{ex}
 
 Denne ligningen sier at intet nytt skjer om du benytter lineærtransformasjonen for andre gang, 
 og det er nettopp den egenskapen vi er ute etter når vi projiserer. 
 Dersom $P$ er en projeksjon, er også $I-P$ det
\[
 (I-P)^2=I^2-2P+P^2=I-P.
 \]
 Dette kalles komplementærprojeksjonen.
 
 I $\C$ er det kun to trivielle projeksjoner. En generell lineærtransformasjon på $\C$ kan skrives 
 \[
 Tx=ax.
 \]
De eneste transformasjonene på denne formen som tifredsstiller $P=P^2$, er
 \[
 Px=x
\]
og 
 \[
 Px=0.
\]
Disse to er ikke så interessante, så vi skal i det etterfølgende anta at antall dimensjoner $n\geq 2$.

La oss si at $P$ har en egenverdi $\lambda$, med egenvektor $\V x$. I så fall må
\[
\lambda \V x=P\V x=P^2\V x=P(P\V x)=P(\lambda\V x)=\lambda P\V x=\lambda^2 \V x.
\]
Hver komponent i denne ligningen gir at
\[
\lambda=\lambda^2
\]
eller
\[
\lambda^2-\lambda=\lambda(\lambda-1)=0.
\]
Egenverdiene til en projeksjonsmatrise kan kun være  0 eller 1. Dette impliserer følgende teoremer.
 
\begin{fishythm}
Mange projeksjonsmatriser er ikke inverterbare.
\end{fishythm}

\begin{thm}
Det finnes alltid vektorer som ikke endres av en bestemt projeksjon.
\end{thm}

Dersom en $2\times 2$-matrise skal være en projeksjon, må egenverdiene være 0 og 1. Dette kan vi bruke til å klassifisere alle projeksjoner i $\C^2$, men vi må vente til neste uke.
 
 I figurene i forrige avsnitt er trekantene rettvinklede. Dette kalles \defterm{ortogonal projeksjon}. 
 Vi skal konsentrere oss om ortogonale projeksjoner fra nå av, 
 og vi skal egentlig bare bruke en type, 
 nemlig den beskrevet i forrige avsnitt. 
 
 

 Hvis du projiserer $\V w_{\V v}$ på $\V v$, får du $\V w_{\V v}$. Kanskje vi skal definere
 \[
 P_{\V v}=\frac{\V v \V v^*}{\V v^* \V v}
 \]
 og 
 \[
 P_{\V v^{\perp}}=I-\frac{\V v \V v^*}{\V v^* \V v}.
 \]

 \begin{center}
\begin{tikzpicture}[scale=.42]
\draw[-latex,thick] (0,0) -- (7,1);
\draw[-latex,thick] (0,0) -- (3,6);
\draw[-latex, thick, red] (0,0) -- (27/50*7,27/50*1);
\draw[-latex,thick, blue] (27/50*7,27/50*1) -- (3,6);
\draw[-]  (27/50*7-1/7,27/50*1+1-1/77) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\draw[-]  (27/50*7+1,27/50*1+1/7) -- (27/50*7+1-1/7,27/50*1+8/7-1/77);
\node[anchor=east] at (9,1.2) {\footnotesize $\V{v}$};
\node[anchor=south] at (3.5,7) {\footnotesize $\V{w}$};
\node[anchor=east,red] at (3.5,-.8) {\footnotesize $P_{\V{v}}(\V w)$};
\node[anchor=east,blue] at (7,3) {\footnotesize $P_{\V{v}^{\perp}}(\V w)$};
%\foreach \x in {-4,-3,-2,-1,1,2,3,4,5,6}
%\draw (\x,5pt) -- (\x,-5pt);
%\foreach \y in {-4,-3,-2,-1,1,2,3,4,5}
%\draw (5pt,\y) -- (-5pt,\y);
%\filldraw (2,3) circle [radius=3pt] node[anchor=west] {$z=2+3i$};
%\filldraw (2,-3) circle [radius=3pt] node[anchor=west] {$\overline z=2-3i$};
%\filldraw (4,5) circle [radius=3pt] node[anchor=west] {$w=4+5i$};
%\filldraw (0,1) circle [radius=3pt] node[anchor=east] {$\V{e}_2$};
%\filldraw (-1,-2) circle [radius=3pt] node[anchor=east] {$\V{u}$};
%\filldraw (3,2) circle [radius=3pt] node[anchor=east] {$\V{v}$};
%\filldraw (1,4) circle [radius=3pt] node[anchor=south] {$A \V{e}_1$};
%\filldraw (3,-3) circle [radius=3pt] node[anchor=north] {$A \V{e}_2$};
%\filldraw (-7,2) circle [radius=3pt] node[anchor=east] {$A \V{u}$};
%\filldraw (9,6) circle [radius=3pt] node[anchor=north] {$A \V{v}$};
%\draw[->,shorten <=4pt,shorten >=4pt] (1,0) to[bend right=20] (1,4);
%\draw[->,shorten <=4pt,shorten >=4pt] (0,1) to[bend right=30] (3,-3);
%\draw[->,shorten <=4pt,shorten >=4pt] (-1,-2) to[bend right=20] (-7,2);
%\draw[->,shorten <=4pt,shorten >=4pt] (3,2) to[bend left=20] (9,6);
\end{tikzpicture}
\\
{\small \textit{Hva er projeksjon III?}}
\end{center}




\section*{Mer om ortogonalitet}
\begin{defnx}
En ortogonal mengde er en mengde vekorer $\V v_1$, $\V v_2$, ...,$\V v_n$, slik at
\[
\V v_i  \V v_k = 0
\]
for alle vektorer $\V v_i$ og $\V v_k$ i mengden. Dersom $\|\V v_i \|=1$ for alle vektorene, sier vi at mengden er ortonormal.
\end{defnx}


\begin{ex}
Den vanlige basisen $\V e_1$, $\V e_2$,...,$\V e_n$ for $\R^n$ og $\C^n$ og  er en ortogonal mengde.
\end{ex}
\begin{ex}
Rekkerommet og nullrommet står ortogonalt på hverandre.
\end{ex}

\section*{Gram-Schmidt}


\section*{Minste kvadraters metode}
Dette er en teknikk for å 'løse' systemer med flere likninger enn ukjente. Kort fortalt projiserer den høyresiden ned i kolonnerommet til matrisen, for å finne punktet med kortest avstand til høyresiden.

\kapittelslutt
